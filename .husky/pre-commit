#!/usr/bin/env sh

# Husky pre-commit hook
# Run lint locally to catch obvious issues quickly.
# Run the full test suite only in CI (CI=true) to avoid flaky network-dependent tests
# blocking local development.

echo "Running linter (errors will abort commit)..."
npm run lint --max-warnings=-1 || echo "⚠️  Linting completed with warnings"

if [ "$CI" = "true" ]; then
	echo "CI environment detected — running full test suite before commit"
	npm test || {
		echo "❌ Tests failed in CI pre-commit. Commit aborted.";
		exit 1;
	}
else
	echo "Not in CI — skipping full test suite. To run tests locally: npm test"
fi
